<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Compositing with Nuke|Keying with Keylight|Advanced Keying">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Screen Color</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/styles.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/tablet.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/mobile.css" rel="stylesheet" />
        <link href="../../assets/stylesheets/nuke_stylesheet.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
        <script src="../../assets/stylesheets/load.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../Default.html#comp_environment/keying_with_keylight/screen_color.html">Open topic with navigation</a>
        </p>
        <script>/* <![CDATA[ */
			$(document).ready(function(){ 
			$('.dropDownMiniTOCmenu:not(:has([class*="MCMiniTocBox"]))').remove();
			});
		/* ]]> */</script>
        <div class="nocontent">
            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
            </div>
        </div>
        <h2><a name="kanchor211"></a>Screen Color</h2>
        <p class="afterHead">The screen color represents the color of the pure blue (or green) screen. The first thing you should do when pulling a key is <a name="kanchor212"></a>pick the <span class="_Override" style="font-weight: bold;">Screen</span> <span class="_Override" style="font-weight: bold;">Color</span>.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;NOTE:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">NOTE:</span> &#160;</span></span>If you press <span class="_Override" style="font-weight: bold;">Alt</span> when sampling a color, <span class="CustomProduct">Nuke</span> always samples the source image regardless of what you’re looking at. This means that you can pick the blue screen color even if you are viewing the matte, status or composite.</p>
        <p class="tip" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;TIP:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">TIP:</span> &#160;</span></span>You can discard sampled pixels by <b>Ctrl</b>/<b>Cmd</b>+right-clicking in the Viewer.</p>
        <p>Picking the <span class="_Override" style="font-weight: bold;">Screen</span> <span class="_Override" style="font-weight: bold;">Color</span> creates the screen matte used to composite the foreground over the background. It also sets the <span class="_Override" style="font-weight: bold;">Screen</span> <span class="_Override" style="font-weight: bold;">Balance</span> and despills the foreground.</p>
        <p>The <span class="_Override" style="font-weight: bold;">Screen</span> <span class="_Override" style="font-weight: bold;">Color</span> is a single color. It has a primary component, blue or green, and that has a saturation. Once the screen color has been picked, Keylight analyzes all the pixels in the image and compares the saturation of the primary component in each of these pixels with the corresponding saturation of the screen color. Keylight uses this comparison to do two things.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>1. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="1. &#160;">It calculates the transparency of that pixel and puts it in the alpha channel.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>2. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="2. &#160;">It removes the screen color from the pixel, a process known as despilling.</td>
            </tr>
        </table>
        <p class="tip" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;TIP:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">TIP:</span> &#160;</span></span>It’s worth sampling a selection of screen (blue or green) colors and viewing the result. Picking different colors gives different results.</p>
        <h3>Background Pixel</h3>
        <p>If the saturation of the pixel in the image is as strong or greater than the screen color, then it’ll be a pixel from the blue screen background, and that pixel is set to completely transparent and black. See the figure below.</p>
        <table style="caption-side: top;">
            <col style="width: 7cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/keylight_graph_377x192.png" class="cm10" style="width: 377;height: 192;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">Blue screen pixel set alpha to zero.</td>
                </tr>
            </tbody>
        </table>
        <h3>Edge Pixel</h3>
        <p>If the saturation of the pixel is less than the screen color, then it’ll be the edge of the foreground object, and we subtract some of the screen color from the pixel (despilling) and set the image to semi-opaque. See the figure below.</p>
        <table style="caption-side: top;">
            <col style="width: 7cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/keylight_edge_pixel_377x188.png" class="cm10" style="width: 377;height: 188;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">Edge pixel gives partial alpha.</td>
                </tr>
            </tbody>
        </table>
        <h3>Foreground pixel</h3>
        <p>If the primary component in the pixel is not the same as the primary component of the screen color, we have a foreground pixel, and the alpha is set to completely opaque. The pixel color is not modified. See the figure below.</p>
        <table style="caption-side: top;">
            <col style="width: 7cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/keylight_graph_377x192.png" class="cm10" style="width: 377;height: 192;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">Foreground pixel gives full alpha.</td>
                </tr>
            </tbody>
        </table>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;NOTE:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">NOTE:</span> &#160;</span></span>You should note that the <span class="_Override" style="font-weight: bold;">Screen</span><span class="_Override" style="font-weight: bold;">Color</span> is a single color. You are not picking lots of colors that are keyed out.</p>
        <h3><a name="kanchor213"></a>Biasing</h3>
        <p>What’s biasing all about? Biasing in Keylight was originally developed for a shot in the motion picture "Executive Decision". The foreground consisted of reddish browns, but a combination of factors led to the 'green screen' being lit so that its primary component was actually slightly red.</p>
        <p class="graphic">
            <img src="../../assets/images/ug_images/keylight_greenscreen2.png" />
        </p>
        <p>So what happens when we pick the screen color? Well because the screen was 'red', as is the foreground, our pilot ends up being keyed out as shown below.</p>
        <p class="graphic">
            <img src="../../assets/images/ug_images/keylight_greenscreen1a_264x134.png" class="cm07" style="width: 264;height: 134;" />
        </p>
        <p>Not a great result, I’m sure you’ll agree, and much pressure was applied to the lowly programmers to get around the problem.</p>
        <p>A work around to this is to manually color correct the image so that the background is properly green, pull the key from this corrected image, then 'un-correct' the result of that so that the foreground colors match the original. A corrected image would look something like the one shown below. The green screen is now strongly green and distinct from the foreground colors. Notice also the red cast on the pilots mask has been removed and turned into a neutral gray.</p>
        <p class="graphic">
            <img src="../../assets/images/ug_images/keylight_greenscreen2a_264x115.png" class="cm07" style="width: 264;height: 115;" />
        </p>
        <p>This is effectively how the Keylight developers got around the problem. They introduced the concept of a 'bias' color, which is a color cast that is removed from the source image and screen color, then a key is pulled from this modified image, then the color cast is put back. In essence, this automates the work around described above, however, it is done in a way that does not slow Keylight down at all.</p>
        <p>For our Executive Decision shot, an appropriate color is the red cast on the pilot's mask in the source footage. Setting our bias to this now gives us the far better result as shown below.</p>
        <p class="graphic">
            <img src="../../assets/images/ug_images/keylight_greenscreen3_264x135.png" class="cm07" style="width: 264;height: 135;" />
        </p>
        <h3>The bias colors in everyday use</h3>
        <p>It also turns out that the bias color is actually useful for situations without strong casts, typically where there is some color spill around the edge of keys. By setting the biases to the main color that occurs near the edge of the foreground (typically flesh tones or hair tones), you allow Keylight to better discriminate between foreground and background.</p>
        <h3>Picking a bias color</h3>
        <p>To pick a bias color, click the color swatch next to <span class="_Override" style="font-weight: bold;">Alpha</span> <span class="_Override" style="font-weight: bold;">Bias</span> to activate an eye dropper and <span class="_Override" style="font-weight: bold;">Ctrl/Cmd+Shift+Alt</span>+drag a box over the image foreground. The average color under the box is used for the bias you have selected.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;NOTE:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">NOTE:</span> &#160;</span></span>If you press <span class="_Override" style="font-weight: bold;">Alt</span> when sampling a color, <span class="CustomProduct">Nuke</span> always samples the source image regardless of what you’re looking at. For instance, you may be looking at the blue screen keyed over the background but you are picking colors from the Source image.</p>
        <p class="tip" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;TIP:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">TIP:</span> &#160;</span></span>You can discard sampled pixels by <b>Ctrl</b>/<b>Cmd</b>+right-clicking in the Viewer.</p>
        <h3>Why are there two bias colors?</h3>
        <p>Remember that Keylight does two things, calculates a transparency and removes the screen color from the foreground. By default, one bias color, the <a name="kanchor214"></a>Alpha Bias, is used for both operations. This works fine in most situations, for example, the Executive Decision shot above.</p>
        <p>However, sometimes you can pick a bias that gives a great alpha, but performs a poor despill, and another bias that gives a great despill, but a poor alpha. Consider the blue screen from the TV series Merlin, courtesy of CFC Framestore shown below in the figure on the left.</p>
        <p>We pick the strong blue of the background without selecting an alpha bias, and end up with the lovely alpha shown on the right, but the despill resulting from this key is poor as shown below.</p>
        <table style="caption-side: top;">
            <col style="width: 5cm;" />
            <col style="width: 5cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/keylight_bluescreen1_264x213.png" class="cm07" style="width: 264;height: 213;" />
                        </p>
                    </td>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/keylight_merlin_alpha_264x211.png" class="cm07" style="width: 264;height: 211;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">Merlin blue screen.</td>
                    <td class="caption">Nice Alpha.</td>
                </tr>
            </tbody>
        </table>
        <p class="tip" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;TIP:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">TIP:</span> &#160;</span></span>There are several nodes in <span class="CustomProduct">Nuke</span> you can use for spill removal. For example, if you are using a greenscreen image, you can add an Expression node after your foreground image and set the expression field for the green channel to:<br />g&gt;(r+b)/2?(r+b)/2:g<br /><br />Similarly, you can despill a bluescreen image by setting the expression field for the blue channel to:<br />b&gt;(r+g)/2?(r+g)/2:b<br /><img src="../../assets/images/ug_images/expression_bluescreen_despill.png" style="margin-left: 1.000063px;margin-top: 1.000063px;margin-right: 0.5198802px;margin-bottom: 0.9997844px;" /><br /><br />You can also use the HueCorrect node for despill. For more information, see <a href="../color_correction/correcting_hue.html" class="noPage MCXref xref xrefnoPage"><span style="color: #00b4e0;" class="mcFormatColor">Correcting Hue Only</span></a>.</p>
        <p>We can pick an alpha bias to get a better despill, but this destroys our nice alpha. The way around this is to turn off the <span class="_Override" style="font-weight: bold;">Use</span> <span class="_Override" style="font-weight: bold;">Alpha</span> <span class="_Override" style="font-weight: bold;">Bias</span> <span class="_Override" style="font-weight: bold;">for</span> <span class="_Override" style="font-weight: bold;">Despill</span>, which gives you a separate bias factor to use solely for despill calculations. If you then pick the <span class="_Override" style="font-weight: bold;">Despill</span> <span class="_Override" style="font-weight: bold;">Bias</span> to be something from Miranda Richardson's hair or skin tone, you keep the nice alpha, and get a good despill as well (see the figure on the right).</p>
        <table style="caption-side: top;">
            <col style="width: 5cm;" />
            <col style="width: 5cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/keylight_bluescreen2_264x212.png" class="cm07" style="width: 264;height: 212;" />
                        </p>
                    </td>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/keylight_bluescreen3_264x212.png" class="cm07" style="width: 264;height: 212;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">
                        <p>Poor despill.</p>
                    </td>
                    <td class="caption">
                        <p>Final key, using separate <br /><span class="_Override" style="font-weight: bold;">Despill</span> and <span class="_Override" style="font-weight: bold;">Alpha</span> <span class="_Override" style="font-weight: bold;">Biases</span>.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <table style="width: 100%;border-bottom-style: solid;border-bottom-width: 1px;">
            <col />
            <tbody>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="MCDropDown MCDropDown_Open dropDown dropDownMiniTOCmenu"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCDropDownHotSpot_MiniTOCmenu MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Topics In This Section</a></span>
            <div class="MCDropDownBody dropDownBody">
            </div>
        </div>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-60569477-1', {'cookieDomain': 'none'});
	/* ]]> */</script>
    <script type="text/javascript">/* <![CDATA[ */
		$("document").ready(function ()
		{
		function postMe()
		{
		var cust = document.getElementById("search-field").value;
		console.log(cust);
		ga('send', 'event', "Nuke", "search", cust, 9);
		}
		var submitButton = $(".search-submit");
		submitButton.click(function() { postMe(); return true; } );
		var submit = $("input#search-field");
		submit.keypress(function(e) { if(e.keyCode==13) { postMe(); } return true; } );
		});
	/* ]]> */</script>
</html>