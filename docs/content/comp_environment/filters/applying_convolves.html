<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Compositing with Nuke|Filtering and Spatial Effects">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Applying Convolves</title>
        <link href="../../../skins/default/stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/styles.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/tablet.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/mobile.css" rel="stylesheet" />
        <link href="../../assets/stylesheets/nuke_stylesheet.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
        <script src="../../assets/stylesheets/load.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../Default.html#comp_environment/filters/applying_convolves.html">Open topic with navigation</a>
        </p>
        <script>/* <![CDATA[ */
			$(document).ready(function(){ 
			$('.dropDownMiniTOCmenu:not(:has([class*="MCMiniTocBox"]))').remove();
			});
		/* ]]> */</script>
        <div class="nocontent">
            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
            </div>
        </div>
        <h1>Applying Convolves</h1>
        <p class="afterHead">The Convolve node lets you create custom filter effects by supplying your own filter image. This image is used as the convolution matrix. In other words, the new value of a pixel is calculated by centering the filter image on the pixel, examining its neighbors, multiplying each pixel value by the corresponding pixel values in the filter image, and then adding the results together. This allows you to defocus a clip and create lens blur effects (bokeh) in the shape of the filter image (also see <a href="applying_blurs.html" class="noPage MCXref xref xrefnoPage"><span style="color: #00b4e0;" class="mcFormatColor">Simulating Depth-of-Field Blurring</span></a>).</p>
        <table style="caption-side: top;">
            <col style="width: 5cm;" />
            <col style="width: 5cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/convolve_before.png" style="margin-left: 1.000063px;margin-top: 1.000063px;margin-right: 0.5198649px;margin-bottom: 0.9997767px;" />
                        </p>
                    </td>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/convolve_shape.png" style="margin-left: 16.35987px;margin-top: 1.000063px;margin-right: 14.91986px;margin-bottom: 0.9997767px;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">The <span class="_Override" style="font-weight: bold;">image</span> input.</td>
                    <td class="caption">The <span class="_Override" style="font-weight: bold;">filter</span> input.</td>
                </tr>
            </tbody>
        </table>
        <table style="caption-side: top;">
            <col style="width: 5cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/convolve_after.png" style="margin-left: 1.000063px;margin-top: 1.000063px;margin-right: 0.5198649px;margin-bottom: 0.9997767px;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">The result.</td>
                </tr>
            </tbody>
        </table>
        <h2>Using the Convolve Node</h2>
        <p class="afterHead">To use the Convolve node:</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>1. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="1. &#160;">Click <span class="_Override" style="font-weight: bold;">Filter</span> &gt; <span class="_Override" style="font-weight: bold;">Convolve</span> to insert a Convolve node after the image you want to receive the convolution filter effect (the <span class="_Override" style="font-weight: bold;">image </span>input).</td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>2. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="2. &#160;">Attach a Viewer to the output of the Convolve node.</td>
            </tr>
        </table>
        <p class="numberedCont">An error appears in the Viewer because we haven’t connected the <span class="_Override" style="font-weight: bold;">filter</span> input yet.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>3. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="3. &#160;">Connect a filter image to the <span class="_Override" style="font-weight: bold;">filter</span> input. This image represents the shape and size of the camera aperture used to shoot the <span class="_Override" style="font-weight: bold;">image</span> input. It can be any shape you like, for example, a pentagon or a hexagon.</td>
            </tr>
        </table>
        <p class="numberedCont">If you don’t have a filter image, you can create one using the Roto node (<span class="_Override" style="font-weight: bold;">Draw</span> &gt; <span class="_Override" style="font-weight: bold;">Roto</span>) or the Flare node (<span class="_Override" style="font-weight: bold;">Draw</span> &gt; <span class="_Override" style="font-weight: bold;">Flare</span>).</p>
        <table style="caption-side: top;">
            <col style="width: 7cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/convolve_nodes.png" style="margin-left: 1.000063px;margin-top: 1.000063px;margin-right: 0.5198802px;margin-bottom: 0.9997844px;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">A simple Convolve setup.</td>
                </tr>
            </tbody>
        </table>
        <p class="numberedCont">Note that you don’t necessarily need to crop the filter image to a smaller size, as fast Fourier transforms are used to speed up convolutions with large filter images.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>4. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="4. &#160;">In the Convolve node controls, set <span class="_Override" style="font-weight: bold;">channels</span> to the channels of the <span class="_Override" style="font-weight: bold;">Source</span> image that you want to affect. By default, the convolve effect is applied to all channels.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>5. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="5. &#160;">To select what channel to use from the <span class="_Override" style="font-weight: bold;">filter</span> input, do one of the following:</td>
            </tr>
        </table>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Set the <span class="_Override" style="font-weight: bold;">filter channel </span>dropdown menu to the channel you want to use. By default, this menu is set to <span class="_Override" style="font-weight: bold;">rgba.alpha</span>.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>To use the same channels from the <span class="_Override" style="font-weight: bold;">filter</span> input as the <span class="_Override" style="font-weight: bold;">image</span> input (that is, whatever <span class="_Override" style="font-weight: bold;">channels</span> is set to), check <span class="_Override" style="font-weight: bold;">use input channels</span>.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>6. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="6. &#160;">In most cases, you can leave <span class="_Override" style="font-weight: bold;">normalize</span> checked. This means the <span class="_Override" style="font-weight: bold;">filter</span> input is divided by the sum of all the pixels in it before using it, and ensures that the convolution doesn’t change the overall brightness of the image.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>7. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="7. &#160;">Use the <span class="_Override" style="font-weight: bold;">filter bounds</span> dropdown menu in the Convolve controls to select whether you want to limit the filter image to:</td>
            </tr>
        </table>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><span class="_Override" style="font-weight: bold;">shape</span> - the <span class="_Override" style="font-weight: bold;">filter</span> input’s bounding box. In this case, Convolve only uses the bounding box area, and the center of the filter is the center of the bounding box. This is the default value. You may want to use it, for example, if your <span class="_Override" style="font-weight: bold;">filter</span> input is a roto shape with a small bounding box that doesn’t fill the entire format area.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><span class="_Override" style="font-weight: bold;">format</span> - the <span class="_Override" style="font-weight: bold;">filter</span> input’s format. In this case, Convolve uses the entire format area, allowing you to offset the filter image within the format.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>8. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="8. &#160;">If you want to mask the convolve effect, check <span class="_Override" style="font-weight: bold;">mask</span> and select a mask channel using the controls on the right. For example, you can select a depth channel as a mask to simulate depth-of-field blurring.</td>
            </tr>
        </table>
        <table style="caption-side: top;">
            <col style="width: 5cm;" />
            <col style="width: 5cm;" />
            <tbody>
                <tr>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/convolve_mask.png" style="margin-left: 1.000063px;margin-top: 1.000063px;margin-right: 0.5198649px;margin-bottom: 1.000059px;" />
                        </p>
                    </td>
                    <td>
                        <p class="graphic">
                            <img src="../../assets/images/ug_images/convolve_masked_result.png" style="margin-left: 1.000063px;margin-right: 0.5198649px;" />
                        </p>
                    </td>
                </tr>
                <tr>
                    <td class="caption">A simple Ramp node used as <br />the mask.</td>
                    <td class="caption">The result.</td>
                </tr>
            </tbody>
        </table>
        <p class="numberedCont">Note that you can also use the ZDefocus node for more accurate depth-of-field blurring. For more information, see <a href="applying_blurs.html" class="noPage MCXref xref xrefnoPage"><span style="color: #00b4e0;" class="mcFormatColor">Simulating Depth-of-Field Blurring</span></a>.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>9. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="9. &#160;">To dissolve between the original <span class="_Override" style="font-weight: bold;">image</span> input and the full convolve effect, adjust the <span class="_Override" style="font-weight: bold;">mix</span> slider.</td>
            </tr>
        </table>
        <p class="tip" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;TIP:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">TIP:</span> &#160;</span></span>You can check <span class="_Override" style="font-weight: bold;">Use GPU if available</span> to have the node run on the graphics processing unit (GPU) rather than the central processing unit (CPU). The output between the GPU and CPU is identical on NVIDIA GPUs, but using the GPU can significantly improve processing performance.<br /><br /><span class="CustomProduct">Nuke</span> supports AMD GPUs on late 2013 Mac Pro 6,1 and mid 2015 Mac Pro 11,5, running OS X 10.9.3 'Mavericks', or later. While, in some cases the bit-wise equality between GPU and CPU holds, for some operations there are limitations to the accuracy possible with this configuration.<br /><br />For more information on the minimum requirements, please see <a href="../../getting_started/installation/mac_os_x.html#installation_and_licensing_4023371737_986201" class="noPage MCXref xref xrefnoPage"><span style="color: #00b4e0;" class="mcFormatColor">Requirements for GPU Acceleration</span></a> or refer to the <span class="CustomProduct">Nuke</span> Release Notes available in <span class="_Override" style="font-weight: bold;">Help</span> &gt; <span class="_Override" style="font-weight: bold;">Release Notes</span>.<br /><br />You can select the GPU to use in the Preferences. Press <span class="_Override" style="font-weight: bold;">Shift</span>+<span class="_Override" style="font-weight: bold;">S</span> to open the <span class="_Override" style="font-weight: bold;">Preferences</span> dialog, make sure you’re viewing the <b>Preferences</b> &gt; <b>Performance</b> &gt; <b>Hardware</b> tab, and set <span class="_Override" style="font-weight: bold;">default blink device</span> to the device you want to use. You must restart <span class="CustomProduct">Nuke</span> for the change to take effect.<br /><br />If you are using a render license of Nuke, you need to add <span class="_Override" style="font-weight: bold;">--gpu</span> on the command line.<br /></p>
        <table style="width: 100%;border-bottom-style: solid;border-bottom-width: 1px;">
            <col />
            <tbody>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="MCDropDown MCDropDown_Open dropDown dropDownMiniTOCmenu"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCDropDownHotSpot_MiniTOCmenu MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../skins/default/stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Topics In This Section</a></span>
            <div class="MCDropDownBody dropDownBody">
            </div>
        </div>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-60569477-1', {'cookieDomain': 'none'});
	/* ]]> */</script>
    <script type="text/javascript">/* <![CDATA[ */
		$("document").ready(function ()
		{
		function postMe()
		{
		var cust = document.getElementById("search-field").value;
		console.log(cust);
		ga('send', 'event', "Nuke", "search", cust, 9);
		}
		var submitButton = $(".search-submit");
		submitButton.click(function() { postMe(); return true; } );
		var submit = $("input#search-field");
		submit.keypress(function(e) { if(e.keyCode==13) { postMe(); } return true; } );
		});
	/* ]]> */</script>
</html>