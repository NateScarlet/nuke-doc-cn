<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Advanced Compositing with NukeX and Nuke Studio|Using MatchGrade">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Matching a Grade Between Two Different Clips</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/styles.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/tablet.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/mobile.css" rel="stylesheet" />
        <link href="../../assets/stylesheets/nuke_stylesheet.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
        <script src="../../assets/stylesheets/load.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../Default.html#comp_environment/matchgrade/matching_different_clips.html">Open topic with navigation</a>
        </p>
        <script>/* <![CDATA[ */
			$(document).ready(function(){ 
			$('.dropDownMiniTOCmenu:not(:has([class*="MCMiniTocBox"]))').remove();
			});
		/* ]]> */</script>
        <div class="nocontent">
            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
            </div>
        </div>
        <h1>Matching a Grade Between Two Different Clips</h1>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>1. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="1. &#160;">Select <b>Color</b> &gt; <b>MatchGrade</b> to insert a MatchGrade node into your script.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>2. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="2. &#160;">Do the following:</td>
            </tr>
        </table>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Connect MatchGrade's <b>Source</b> input to the clip to which you want to apply the color transform.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Connect the <b>Target</b> input to the clip you want to match. This should be a completely different clip, a stereo pair for the <b>Source</b> clip, or the <b>Source</b> clip in a different format.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Connect a Viewer to the output of MatchGrade.</p>
        <p class="graphic">
            <img src="../../assets/images/ug_images/matchgrade_different_nodes_378x274.png" style="width: 378;height: 274;" />
        </p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>3. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="3. &#160;">In the MatchGrade properties, set <b>Task</b> to <b>Match Different Clip</b>.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>4. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="4. &#160;">Set <b>Output</b> to <b>Source </b>and then <b>Target</b> to compare the <b>Source</b> and <b>Target</b> images. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>5. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="5. &#160;">When you find frames that cover similar content in the <b>Source</b> and <b>Target</b> clips, click on the <img src="../../assets/images/ug_images/icon_keys1.png" alt="" title="" style="vertical-align: middle;" /> buttons next to <b>Source</b> and <b>Target</b> to set the current frame as a reference frame. Only frames set as reference frames are used in the MatchGrade analysis.</td>
            </tr>
        </table>
        <p class="numberedCont">For example, if you want grass in the <b>Source</b> clip to have the same color as grass in the <b>Target</b> clip, you need to choose frames where the relative amount of grass pixels is roughly the same. The more similar the content, the better MatchGrade is able to match the colors.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;NOTE:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">NOTE:</span> &#160;</span></span>You do not need to use the same number of <b>Source</b> and <b>Target</b> reference frames or set the same frames as reference frames for both.</p>
        <p class="numberedCont">If necessary, you can also use the <img src="../../assets/images/ug_images/icon_keys.png" alt="" title="" style="vertical-align: middle;" />button to remove a frame from the set of reference frames.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>6. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="6. &#160;">If you only want to match certain elements between the <b>Source</b> and <b>Target</b> clips, supply a mask in both the <b>Source</b> and <b>Target</b> inputs' alpha channels and set <b>Mask</b> to either:</td>
            </tr>
        </table>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Alpha</b> - to use the alpha channel from both inputs as a mask. Only the non-black areas of the <b>Source</b> and <b>Target</b> inputs' alpha channels are used in the MatchGrade analysis, and the grade is limited to the non-black areas of the <b>Source</b> alpha.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Inverted Alpha</b> - to use the inverted alpha channel from both inputs as a mask. Only the non-white areas of the  <b>Source</b> and <b>Target</b> inputs' alpha channels are used in the MatchGrade analysis, and the grade is limited to the non-white areas of the <b>Source</b> alpha.</p>
        <p class="numberedCont">Masks can also be useful if you cannot find frames that cover approximately the same amount of similar content. For example, if the <b>Source</b> and <b>Target</b> inputs have a different amount of grass and sky, you can use a Roto node in both inputs to create masks that cover the same amount of grass and sky. Bear in mind that if you do so, the grade is only applied to the areas indicated by the mask in the <b>Source</b> input. To apply it to the entire frame, you need to export the grade first. For more information, see step 12.</p>
        <table>
            <col style="width: 7cm;" />
            <col style="width: 7cm;" />
            <tbody>
                <tr>
                    <td>
                        <img src="../../assets/images/ug_images/matchgrade_different_source_378x212.png" style="width: 378;height: 212;" />
                    </td>
                    <td>
                        <img src="../../assets/images/ug_images/matchgrade_different_target_mask_378x212.png" style="width: 378;height: 212;" />
                    </td>
                </tr>
                <tr>
                    <td class="caption">The <b>Source</b> image. In this case, you can set this image to have a fully opaque alpha...</td>
                    <td class="caption">...and draw a mask like this on the <b>Target</b> image to ensure both inputs cover similar content.</td>
                </tr>
            </tbody>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>7. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="7. &#160;">When you're done setting reference frames, use the <b>Transform</b> dropdown menu to choose how to calculate the grade:</td>
            </tr>
        </table>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>3D LUT</b> - Calculate the grade as a 3D look-up table (LUT). This allows you to export the grade to a <b>.csp</b> format, which you can use with the OCIOFileTransform node.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>CDL</b>&#160;- Calculate the grade as a color decision list (CDL). This allows you to export the grade to an OCIOCDLTransform node. </p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;NOTE:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">NOTE:</span> &#160;</span></span>The <b>CDL</b> transform is limited and cannot model all types of color transformation. In most cases, selecting <b>3D LUT</b> gives the best results.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>8. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="8. &#160;">Set <b>Output</b> back to <b>Matched</b> and click <b>Analyze Reference Frames</b>.</td>
            </tr>
        </table>
        <p class="numberedCont">MatchGrade calculates the transform needed to match the <b>Source</b> image to the <b>Target</b> image.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>9. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="9. &#160;">To evaluate the results, select the MatchGrade node and press <b>D</b> repeatedly to toggle between the original <b>Source</b> image and the graded output.</td>
            </tr>
        </table>
        <table>
            <col style="width: 7cm;" />
            <col style="width: 7cm;" />
            <tbody>
                <tr>
                    <td>
                        <img src="../../assets/images/ug_images/matchgrade_different_source_378x212.png" style="width: 378;height: 212;" />
                    </td>
                    <td>
                        <img src="../../assets/images/ug_images/matchgrade_different_target_378x212.png" style="width: 378;height: 212;" />
                    </td>
                </tr>
                <tr>
                    <td class="caption">The <b>Source</b> image.</td>
                    <td class="caption">The <b>Target</b> image.</td>
                </tr>
            </tbody>
        </table>
        <table>
            <col style="width: 7cm;" />
            <tbody>
                <tr>
                    <td>
                        <img src="../../assets/images/ug_images/matchgrade_different_result_378x212.png" style="width: 378;height: 212;" />
                    </td>
                </tr>
                <tr>
                    <td class="caption">The color-matched result.</td>
                </tr>
            </tbody>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>10. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="10. &#160;">If you're not happy with the results, try one or more of the following:</td>
            </tr>
        </table>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Look for better reference frames or use a mask in the <b>Target</b> input to make sure both inputs cover approximately the same amount of similar content.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Use the <b>Pre LUT</b>&#160;dropdown menu to specify a 1D shaper LUT to use for the analysis: <b>Linear</b> or <b>Logarithmic</b>.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Increase the <b>LUT Resolution</b> value. This is the resolution of the look-up table (LUT) in which MatchGrade stores the color transformation. Higher values can improve the results, but also increase processing time. The maximum value is 64.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Set<b> Colorspace</b> to a different value. The correct setting to use depends on the nature of the transformation. Try each option to see which works best with your footage.</p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>Increase the <b>Iterations</b> value. This determines the number of refinement passes. Higher values can produce a better color match, but also take longer to process.</p>
        <p class="numberedCont">To update the results, click <b>Analyze Reference Frames</b> again.</p>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>11. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="11. &#160;">If you set <b>Transform</b> to <b>CDL</b> in step 8, you can fine-tune the grade manually by adjusting <b>slope</b>, <b>offset</b>, <b>power</b>, and <b>saturation</b>. The <b>lock</b> controls on the right prevent the values from being recalculated when you click <b>Recalculate CDL</b>, allowing you to set some values manually and estimate others automatically. For example, you can adjust and lock <b>slope</b> and <b>offset</b> and then click <b>Recalculate CDL</b> to automatically recalculate <b>power</b> and <b>saturation</b>.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 25px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_numbered1" valign="top"><span>12. &#160;</span>
                </td>
                <td class="AutoNumber_p_numbered1" valign="top" data-mc-autonum="12. &#160;">If necessary, you can export the calculated grade and apply it to other nodes in your script. How you do this depends on whether you chose to calculate the grade as a 3D LUT or a CDL:</td>
            </tr>
        </table>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>If you set <b>Transform</b> to <b>3D LUT</b>, you can write the LUT&#160;into a <b>.csp</b> file and create an OCIOFileTransform node that you can use elsewhere in the script to apply the same grade. To do so, enter a file path and name for the <b>.csp</b> file in the <b>LUT&#160;output file</b> field and click <b>Write</b> to export the LUT. Then, click <b>Create OCIOFileTransform</b> to create an OCIOFileTransform node that applies the color transform from the <b>.csp</b> file.</p>
        <p class="graphic">
            <img src="../../assets/images/ug_images/matchgrade_different_ociofiletransform_378x205.png" style="width: 378;height: 205;" />
        </p>
        <p class="processBullet" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>If you set <b>Transform</b> to <b>CDL</b>, you can click <b>Create OCIOCDLTransform</b> to create an OCIOCDLTransform node that uses the values in the <b>CDL&#160;Output</b> section of the MatchGrade properties.</p>
        <p class="graphic">
            <img src="../../assets/images/ug_images/matchgrade_different_ociocdltransform_378x205.png" style="width: 378;height: 205;" />
        </p>
        <p class="tip" data-mc-autonum="&lt;span style=&quot;color: Black;&quot; class=&quot;mcFormatColor&quot;&gt;TIP:&lt;/span&gt; &#160;"><span class="autonumber"><span><span style="color: Black;" class="mcFormatColor">TIP:</span> &#160;</span></span>You can also apply the grade to a different source by simply connecting a new node to MatchGrade's <b>Source</b> input.</p>
        <table style="width: 100%;border-bottom-style: solid;border-bottom-width: 1px;">
            <col />
            <tbody>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="MCDropDown MCDropDown_Open dropDown dropDownMiniTOCmenu"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCDropDownHotSpot_MiniTOCmenu MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Topics In This Section</a></span>
            <div class="MCDropDownBody dropDownBody">
            </div>
        </div>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-60569477-1', {'cookieDomain': 'none'});
	/* ]]> */</script>
    <script type="text/javascript">/* <![CDATA[ */
		$("document").ready(function ()
		{
		function postMe()
		{
		var cust = document.getElementById("search-field").value;
		console.log(cust);
		ga('send', 'event', "Nuke", "search", cust, 9);
		}
		var submitButton = $(".search-submit");
		submitButton.click(function() { postMe(); return true; } );
		var submit = $("input#search-field");
		submit.keypress(function(e) { if(e.keyCode==13) { postMe(); } return true; } );
		});
	/* ]]> */</script>
</html>