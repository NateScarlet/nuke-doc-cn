<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Reference Guide|Other Nodes">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Precomp</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/styles.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/tablet.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/mobile.css" rel="stylesheet" />
        <link href="../../assets/stylesheets/master_tablestyle.css" rel="stylesheet" />
        <link href="../../assets/stylesheets/nuke_stylesheet.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
        <script src="../../assets/stylesheets/load.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../Default.html#reference_guide/other_nodes/precomp.html">Open topic with navigation</a>
        </p>
        <script>/* <![CDATA[ */
			$(document).ready(function(){ 
			$('.dropDownMiniTOCmenu:not(:has([class*="MCMiniTocBox"]))').remove();
			});
		/* ]]> */</script>
        <div class="nocontent">
            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
            </div>
        </div>
        <h1>Precomp</h1>
        <p>The Precomp node is like a <a href="group.html" class="noPage MCXref xref xrefnoPage"><span style="color: #00b4e0;" class="mcFormatColor">Group</span></a> node, but its content is stored in an independent <b>.nk</b> file. This allows you to save a subset of the node tree as a separate Nuke script, render the output of this saved script, and read the rendered output back into the main comp as a single image input. Precomp nodes can be useful in at least two ways:</p>
        <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>They can be used to reduce portions of the node tree to pre-rendered image inputs. This speeds up render time, as Nuke only has to process the single image input instead of all the nodes that were used to create it. Because the original nodes are saved in a separate <b>.nk</b> script, you also maintain access to them and can adjust them later if necessary.</p>
        <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span>They enable a collaborative workflow. While one artist works on the main comp, others can work on the sections that have been exported using the Precomp node. These sections can be edited, versioned, and managed independent of the main comp.</p>
        <p>You can also create this node by pressing <span class="_Override" style="font-weight: bold;">Ctrl</span>/<span class="_Override" style="font-weight: bold;">Cmd</span>+<span class="_Override" style="font-weight: bold;">Shift</span>+<span class="_Override" style="font-weight: bold;">P</span> on the Node Graph.</p>
        <p>See also <a href="group.html" class="noPage MCXref xref xrefnoPage"><span style="color: #00b4e0;" class="mcFormatColor">Group</span></a>.</p>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /><span class="Master_VariablesRGContent">Inputs and Controls</span></a></span>
            <div class="MCDropDownBody dropDownBody">
                <table style="width: 100%;mc-table-style: url('../../assets/stylesheets/master_tablestyle.css');" class="TableStyle-Master_TableStyle" cellspacing="0">
                    <col class="TableStyle-Master_TableStyle-Column-Column1" style="width: 144px;" />
                    <col class="TableStyle-Master_TableStyle-Column-Column1" style="width: 139px;" />
                    <col class="TableStyle-Master_TableStyle-Column-Column1" style="width: 122px;" />
                    <col class="TableStyle-Master_TableStyle-Column-Column1" />
                    <thead>
                        <tr class="TableStyle-Master_TableStyle-Head-Header1">
                            <th class="TableStyle-Master_TableStyle-HeadE-Column1-Header1">
                                <p class="CellHeading">Control (UI)</p>
                            </th>
                            <th class="TableStyle-Master_TableStyle-HeadE-Column1-Header1">
                                <p>Knob (Scripting)</p>
                            </th>
                            <th class="TableStyle-Master_TableStyle-HeadE-Column1-Header1">
                                <p class="CellHeading">Default Value</p>
                            </th>
                            <th class="TableStyle-Master_TableStyle-HeadD-Column1-Header1">
                                <p>Function</p>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-Master_TableStyle-Body-Subheading" data-mc-pattern="6">
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Subheading" colspan="4">
                                <p>Precomp Tab</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>file</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>file</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>N/A</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body2">
                                <p>Sets the <b>.nk</b> script to use as the contents of the precomp.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>Reload</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>reload_script</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>N/A</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body1">
                                <p>Click to reload the <b>.nk</b> script specified in the <b>file</b> control.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>Open</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>open</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>N/A</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body2">
                                <p>Click to open the <b>.nk</b> script specified in the <b>file</b> control in a new <span class="CustomProduct">Nuke</span> session.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>Render</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>render</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>N/A</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body1">
                                <p>Click to render the <b>.nk</b> script specified in the <b>file</b> control and output the results from the Precomp node.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>read file for output</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>reading</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>disabled</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body2">
                                <p>When enabled, the Precomp node reads in the rendered precomp image rather than calculating the output of the precomp script.</p>
                                <p>When disabled, <span class="CustomProduct">Nuke</span> calculates the output of the precomp script.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>missing frames</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>on_error</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>error</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body1">
                                <p>Sets the behavior when there is an error opening the output file:</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>error</b> - display an error message on any missing frames.</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>black</b> - replace any missing frames with black.</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>checkerboard</b> - replace any missing frames with a checkerboard image.</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>read input</b> - display the result of the input tree rather than the rendered file on any missing frames.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>Reload</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>reload_write</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>N/A</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body2">
                                <p>Click to re-read the image from disk. </p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body1" colspan="4">
                                <p>advanced</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>output node</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>output</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>N/A</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body2">
                                <p>Sets the name of the Write node  to use instead of the Output node in the precomp.</p>
                                <p>You can use this control to override what is set as the Output node in the precomp script.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyB-Column1-Body1">
                                <p>enable</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyB-Column1-Body1">
                                <p>use_output</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyB-Column1-Body1">
                                <p>disabled</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyA-Column1-Body1">
                                <p>When enabled, the Write node specified in the <b>output node</b> control is used instead of the Output node in the precomp.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /><span class="Master_VariablesUGContent">Step-by-Step Guides</span></a></span>
            <div class="MCDropDownBody dropDownBody">
                <p><a href="../../comp_environment/organizing_scripts/using_precomp_node.html" class="noPage MCXref xref xrefnoPage"><span style="color: #00b4e0;" class="mcFormatColor">Using the Precomp Node</span></a>
                </p>
            </div>
        </div>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /><span class="Master_VariablesVideoContent">Video Tutorials</span></a></span>
            <div class="MCDropDownBody dropDownBody">
                <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeaddropDownHeadNoBold"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Nuke's Precomp Node</a></span>
                    <div class="MCDropDownBody dropDownBody"><iframe src="https://player.vimeo.com/video/20581146?color=f9b41b;byline=0;portrait=0" width="500" height="313" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
                        <p><a href="https://vimeo.com/20581146" target="_blank">NUKE's Precomp node with Frank Rueter</a> from <a href="https://vimeo.com/thefoundry" target="_blank">Foundry</a> on <a href="https://vimeo.com/" target="_blank">Vimeo</a>.</p>
                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeaddropDownHeadIndented"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /><span class="Master_VariablesTranscribedContent">Transcription</span></a></span>
                            <div class="MCDropDownBody dropDownBody">
                                <p>Nuke 6 introduces the Precomp node, or precomp workflow, which enables you to deal with more complex scripts in a more efficient way, as well as use a collaborative workflow with Nuke.  So, in this tutorial we will investigate a few of its options.</p>
                                <p>This script here is a very straightforward matte painting. At the top here, we have a sky, and we have added a live action plate and some foreground in front of that all the way until we have our final framing. What I want to do now is replace the sky at the top with a Precomp node. I’m just going to select it, right-click, go to the <b>Other</b> &gt; <b>Precomp</b>. That brings up a panel that prompts us for a Nuke script, a render sequence, channels, and what to do with the original nodes. Let’s start at the top. The Precomp script I want to generate with those selected nodes, I will call that <b>skyPrecomp</b> instead of the default <b>Precomp1</b>. The default location is where my current script is, and that’s fine. Then we have the render path for the intermediate renders, which I will change to point into the render sub-directory. I will call them <b>skyPrecomp</b> as well and save as an <b>.exr</b>.</p>
                                <p>When we render the Precomp, all I want to render is rgb because I don’t care about the other channels. And then finally, because we will be replacing the Precomp node, we get to choose what we do with the currently selected nodes. Do we want to keep them or just backdrop them (<b>add backdrop</b>) to keep them in our main script? Do we want to just keep them as is (<b>no change</b>) or do we want to <b>delete</b> them? Since I want to clean up my main comp, I will just delete them. And now, finally, when I hit <b>OK</b>, it will generate the skyPrecompV1 script and, in this case, we will just overwrite the one that already exists on disk. And the last step, Nuke prompts us to choose the node we want to use as the Precomp’s output. That will be fed into the main comp’s input. So, Crop24 was the node we looked at a second ago, and that’s the one we need, so I will hit <b>OK</b>.</p>
                                <p>All my nodes have now been replaced by a single Precomp node that makes my main comp a bit tidier. In the panel, you can see which Nuke script this Precomp node references, and if we want to see the internals of this external script, we just hit <b>Open</b>. That opens a new instance of Nuke and shows us the Nodes we just exported into the Precomp script. At the bottom of the node that we designated as our Precomp’s output, we will see the Write node that we defined with our <b>skyPrecomp.exr</b> sequence and the channels set to rgb. That’s what we just did in the Python panel, followed by an Output node. The Output node is not strictly required in the Precomp script, but it’s a good idea to have it because it makes it very obvious which node in the Precomp script feeds into the main comp. So, just to illustrate how this works now, I will just bring up the Viewer in my Precomp and deactivate all of the Grade nodes, for example. Save this, then back in my main comp I will hit <b>Reload</b>, and we will see the change of the external Precomp script reflected in our main comp because it’s been pulled in through this node. You will also notice that we get those input pipes. That’s because when you create a Precomp, it works in a very similar way to creating a Group node, which means every unconnected node in your Precomp, or your node selection, gets an Input node. I want to get rid of those because we don’t want any Inputs. I will select them, go to <b>Edit</b> &gt; <b>Select Similar</b> &gt; <b>Class</b>, and that will select all of the Input nodes in my script, and I will just <b>Delete</b> them. Save again, and now if I reload the script, those input pipes disappear, and everything is nice and tidy now.</p>
                                <p>Back in our Precomp, let’s reactivate the Grade and add this moon into the upper right corner.  Let me version up my Write node. I will just go to <b>Alt</b>+<b>up arrow</b> or <b>Edit</b> &gt; <b>Node</b> &gt; <b>Filename</b> &gt; <b>Version Up</b>. Now my Write node is version 02, I will go ahead and save a new version of my script: <b>File</b> &gt; <b>Save New Version</b>. So our skyPrecomp becomes version 2 as well. In our main comp, we can use the same up versioning, so I will hit <b>Alt</b>+<b>up arrow</b> on my Precomp, which will change its version number and now point to the version 2 script.</p>
                                <p>So, you will see that we can now easily hand this over to a matte painter to keep working on the sky. Every time he saves, we can reload and we get his updated work in our main comp. Also, if this gets too heavy because this is actually live processing the external tree, we can always choose to <b>Render</b> the tree into its output. Let me just render the first frame, hit <b>OK</b>, and once the render is done, the option <b>read file for output</b> checks itself automatically. The Precomp node will go green and the auto-label will now tell you that it is now reading the image file from disk, rather than the Nuke script. This will obviously make your main comp run faster.</p>
                                <p>Now, lets go back to our Precomp script. We want to keep control of that moon in our main script, so I will cut that from here and paste it into our main comp. In order to combine the moon with our main script, we need an input pipe again. Since we deleted them, we will have to go back and create a new input. I will just attach an Input node as a placeholder for the moon in our Precomp script, and save again. Back in our main comp, I will hit <b>Reload</b> and we will see two things. First of all, we will get an error because the Precomp script has changed on disk, and therefore, its rendered file may be out-of-date. That’s what this error is saying. So, you should uncheck <b>read file for output</b> to make sure you are reading the up-to-date Precomp script from disk again, and now that we added an input node, we also get the new pipe. So, now we can plug the moon in here and keep control over it in the main comp, but it’s being combined with the Precomp script, according to where this input is in the Precomp script. That way, you can interlace your Precomp and your main comp, and still create a collaborative workflow.</p>
                                <p>Once all of this is done, let’s say we need to start a new shot and we want to start with an already existing Precomp script. All we need to do is create a Precomp node with nothing selected, and if nothing is selected, then all we get is an empty Precomp node. Now, we can manually browse for the already established Precomp, and there we are. Now we can start a new script with this Precomp node in place.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <p data-mc-conditions="Default.ScreenOnly"><a href="javascript:void(0);" class="MCHelpControl MCHelpControl-Related relatedTopics" data-mc-topics="Group|group.html"><span class="MCHelpControl-RelatedHotSpot_"><img class="MCHelpControl_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Related Topics Link Icon" />Related Topics</span></a>
        </p>
        <table style="width: 100%;border-bottom-style: solid;border-bottom-width: 1px;">
            <col />
            <tbody>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="MCDropDown MCDropDown_Open dropDown dropDownMiniTOCmenu"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCDropDownHotSpot_MiniTOCmenu MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Topics In This Section</a></span>
            <div class="MCDropDownBody dropDownBody">
            </div>
        </div>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-60569477-1', {'cookieDomain': 'none'});
	/* ]]> */</script>
    <script type="text/javascript">/* <![CDATA[ */
		$("document").ready(function ()
		{
		function postMe()
		{
		var cust = document.getElementById("search-field").value;
		console.log(cust);
		ga('send', 'event', "Nuke", "search", cust, 9);
		}
		var submitButton = $(".search-submit");
		submitButton.click(function() { postMe(); return true; } );
		var submit = $("input#search-field");
		submit.keypress(function(e) { if(e.keyCode==13) { postMe(); } return true; } );
		});
	/* ]]> */</script>
</html>