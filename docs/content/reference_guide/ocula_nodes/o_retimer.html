<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Reference Guide|Ocula 3.0 Nodes">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>O_Retimer</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/styles.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/tablet.css" rel="stylesheet" />
        <link href="../../../skins/default/stylesheets/components/mobile.css" rel="stylesheet" />
        <link href="../../assets/stylesheets/master_tablestyle.css" rel="stylesheet" />
        <link href="../../assets/stylesheets/nuke_stylesheet.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
        <script src="../../assets/stylesheets/load.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../Default.html#reference_guide/ocula_nodes/o_retimer.html">Open topic with navigation</a>
        </p>
        <script>/* <![CDATA[ */
			$(document).ready(function(){ 
			$('.dropDownMiniTOCmenu:not(:has([class*="MCMiniTocBox"]))').remove();
			});
		/* ]]> */</script>
        <div class="nocontent">
            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
            </div>
        </div>
        <h1>O_Retimer</h1>
        <p>O_Retimer is designed to slow down or speed up stereo footage using upstream motion vectors generated by the O_VectorGenerator node. These motion vectors describe how each pixel moves from frame to frame. With accurate motion vectors, it is possible to generate an output image at any point in time throughout the sequence by interpolating along the direction of the motion. </p>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /><span class="Master_VariablesRGContent">Inputs and Controls</span></a></span>
            <div class="MCDropDownBody dropDownBody">
                <table cellpadding="0" cellspacing="0" style="border-spacing-x: 0;border-spacing-y: 0;border-collapse: collapse;border-color: black;caption-side: top;width: 100%;mc-table-style: url('../../assets/stylesheets/master_tablestyle.css');" class="TableStyle-Master_TableStyle" height="141px">
                    <col width="105px" class="TableStyle-Master_TableStyle-Column-Column1" />
                    <col width="120px" class="TableStyle-Master_TableStyle-Column-Column1" />
                    <col width="436px" class="TableStyle-Master_TableStyle-Column-Column1" />
                    <thead>
                        <tr style="height: 23px;background-color: #cac8c9;" class="TableStyle-Master_TableStyle-Head-Header1">
                            <td class="TableStyle-Master_TableStyle-HeadE-Column1-Header1" style="font-weight: bold;">
                                <p class="CellHeading">Connection Type</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-HeadE-Column1-Header1" style="font-weight: bold;">
                                <p class="CellHeading">Connection Name</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-HeadD-Column1-Header1" style="font-weight: bold;">
                                <p class="CellHeading">Function</p>
                            </td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1" rowspan="2">
                                <p>Input</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>Motion</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body1">
                                <p>If a stereo image and an O_VectorGenerator node are supplied here, motion vectors will be calculated from this sequence and applied to the input sequence.</p>
                                <p>This can be useful if, for example, your input sequence is very noisy, as too much noise interferes with the motion estimation. In that case, you should supply a smoothed version of the sequence and an O_VectorGenerator node here.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyB-Column1-Body2">
                                <p>Source</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyA-Column1-Body2">
                                <p>A stereo pair of images.</p>
                                <p>If motion vectors aren’t embedded in the images, you should use a O_VectorGenerator node to calculate them.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table cellpadding="0" cellspacing="0" style="border-spacing-x: 0;border-spacing-y: 0;border-collapse: collapse;border-color: black;caption-side: top;width: 100%;mc-table-style: url('../../assets/stylesheets/master_tablestyle.css');" class="TableStyle-Master_TableStyle" height="603px">
                    <col width="100px" class="TableStyle-Master_TableStyle-Column-Column1" />
                    <col width="117px" class="TableStyle-Master_TableStyle-Column-Column1" />
                    <col width="108px" class="TableStyle-Master_TableStyle-Column-Column1" />
                    <col width="364px" class="TableStyle-Master_TableStyle-Column-Column1" />
                    <thead>
                        <tr style="height: 23px;background-color: #cac8c9;" class="TableStyle-Master_TableStyle-Head-Header1">
                            <td class="TableStyle-Master_TableStyle-HeadE-Column1-Header1" style="font-weight: bold;">
                                <p class="CellHeading">Control (UI)</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-HeadE-Column1-Header1" style="font-weight: bold;">
                                <p class="CellHeading">Knob (Scripting)</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-HeadE-Column1-Header1" style="font-weight: bold;">
                                <p class="CellHeading">Default Value</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-HeadD-Column1-Header1" style="font-weight: bold;">
                                <p class="CellHeading">Function</p>
                            </td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="height: 15px;" class="TableStyle-Master_TableStyle-Body-Subheading" data-mc-pattern="6">
                            <td colspan="4" class="TableStyle-Master_TableStyle-BodyD-Column1-Subheading">
                                <p>O_Retimer Tab</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>Views to Use</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>viewPair</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>Dependent on Source</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body2">
                                <p>Sets the two views you want to use to retime the clip. These views will be mapped for the left and right eye.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>Timing</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>timing</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>Speed</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body1">
                                <p>Sets how to control the new timing of the clip:</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Speed</b> - select this if you wish to describe the retiming in terms of overall duration: double speed will halve the duration of the clip or half speed will double the duration of the clip. </p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Source Frame</b> - select this if you wish to describe the retiming in terms of ‘at frame 100 in the output clip, I want to see frame 50 of the source clip‘. You’ll need to set at least two keyframes for this to retime the clip. </p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>Speed</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>speed</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body2">
                                <p>0.5</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body2">
                                <p>Sets the retime value when <b>Timing</b> is set to <b>Speed</b>.</p>
                                <p>Values below 1 slow down the clip and values above 1 speed up movement. For example, to slow down the clip by a factor of two (half speed), set this value to 0.5. Quarter speed would be 0.25.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body1">
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>Frame</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>frame</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyE-Column1-Body1">
                                <p>1</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyD-Column1-Body1">
                                <p>Sets the retime value by altering the source frame at the current frame in the timeline, when <b>Timing</b> is set to <b>Frame</b>.</p>
                                <p>For example, to slow down a 50 frame clip by half, set the <span class="_Override" style="font-weight: bold;">Source Frame</span> to 1 at frame 1 and the <span class="_Override" style="font-weight: bold;">Source Frame</span> to 50 at frame 100. The default expression will result in a half-speed retime.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-Master_TableStyle-Body-Body2">
                            <td class="TableStyle-Master_TableStyle-BodyB-Column1-Body2">
                                <p>Warp Mode</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyB-Column1-Body2">
                                <p>warpMode</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyB-Column1-Body2">
                                <p>Normal</p>
                            </td>
                            <td class="TableStyle-Master_TableStyle-BodyA-Column1-Body2">
                                <p>Sets the method to use to generate the retimed views:</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Simple</b> - this mode warps and blends the images.</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Normal</b> - this mode warps and blends the images where they are consistent.</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Occlusions</b> - this mode may improve the results with large motion vectors.</p>
                                <p class="bulleted" data-mc-autonum="• "><span class="autonumber"><span>• </span></span><b>Sharp Occlusions</b> - this mode is designed to reduce artefacts with a CG source where boundaries are distinct.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /><span class="Master_VariablesVideoContent">Video Tutorials</span></a></span>
            <div class="MCDropDownBody dropDownBody">
                <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeaddropDownHeadNoBold"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Ocula 3.0 - Retimer</a></span>
                    <div class="MCDropDownBody dropDownBody"><iframe src="https://player.vimeo.com/video/33670539?color=f9b41b;byline=0;portrait=0" width="500" height="281" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
                        <p><a href="https://vimeo.com/33670539" target="_blank">OCULA 3.0 - Retimer</a> from <a href="https://vimeo.com/thefoundry" target="_blank">Foundry</a> on <a href="https://vimeo.com/" target="_blank">Vimeo</a>.</p>
                        <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeaddropDownHeadIndented"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" /><span class="Master_VariablesTranscribedContent">Transcription</span></a></span>
                            <div class="MCDropDownBody dropDownBody">
                                <p>Welcome to Ocula from Foundry. My name is Jon and in this tutorial we're taking a look at retiming with Ocula 3.0. So, here’s the Ocula tree we’re going to take a look at. At the top, I have got a Solver calculating the stereo geometry for the plates. I am doing some plate correction, so vertical alignment and colour matching between the left and right views, then baking out the disparity and the motion vectors for use later on, and here we are using it to do a retime on the plates. So, here we are going to do an Ocula 3.0 retime, and see how that compares to retiming the left and right views separately with Kronos. At the bottom, we are going to look at a trick to help fix up retime if you are not quite satisfied with the result.</p>
                                <p>Let’s look at the plate preparation first. Here, I have got my Solver node. I am calculating disparity and occlusions so I can do a local colour correction, pulling the colour from the left onto the right view using that disparity. Then I am aligning the plates using a set of VerticalAligners, so let’s look at each of these in turn. On the Solver node, I have laid down 3 keys at the start, middle, and end of the shot. This camera rig isn’t actually changing, but I want to make sure I pick up any slight shifts in the alignment. There is a tutorial on the Solver node, which will tell you how to set up and QC (quality-check) these keys to make sure you get the best possible alignment data delivered by O_Solver. So, once I have my solve, I can calculate the disparity, and I have got this set up with the default values. From disparity, I can calculate the occlusions between left and right view, again with the defaults. There are no large changes in depth I need to worry about in this shot. Then I do my colour match, and I have this set up to match the right view to the colour of the left. So, we can take a look at that now. Here’s our input footage and here’s the correction. When I switch views on the input, you can see a shift in the reflections. I am going to look at the corrected plate. The colour now matches, but you can see the misalignment between the left and right view. Then I have my 3 VerticalAligners down here. The first I have set to <b>Scale</b> to take out any focal length differences. Then I have a <b>Rotation</b> to take out camera roll, and finally I have an Aligner set to <b>Vertical Skew</b> to take out any keystoning. We can look at the final corrected plates. When I switch between left and right views, now you can see they are aligned.</p>
                                <p>Once you have your plate correction, you can render it out. I am rendering it with disparity for the aligned plates, so I don’t need to re-calculate that disparity later on. Remember that you can’t use the input disparity because that won’t match the shift the image has gone through in vertical alignment. You need to re-calculate the disparity. So I am pulling that back in. Here is our corrected plate with disparity, and I am putting that into an O_VectorGenerator node. This calculates stereo motion vectors. Disparity is the vector that connects pixels between the left and right view, and motion connects pixels between frames. Forward motion connects pixels to the next frame, and backward to the previous frame, but for a particular view. On the VectorGenerator, we have an <b>Ignore Mask</b>. This excludes regions from the motion calculation. There is also a <b>Foreground Mask</b>. This let’s you cut out and calculate motion for a particular foreground layer. You also have the same parameters to tune as the DisparityGenerator. It will work in very much the same way. So, let’s have a look at the vectors we are calculating here. I am going to switch to looking at the <b>forward</b> motion. Turn this down a little bit, so we can see it more easily, and if I look at a pixel, the red and green channels tell me the x and y offset to the next frame. If you turn up <b>Strength</b>, you can force the motion vectors to match frames. Try this if you have ghosting in your retime where the frames aren’t quite aligned. The trade off here is that the result could have some artefacts, some noise in it. You can also tune <b>Sharpness</b>. This helps to match frames as well as lets the motion separate into different layers. Now we can see the axis starting to appear. Finally, you can smooth that out, if it’s too noisy, using the <b>Smoothness</b> parameter. Now this looks good, but if the layers separate too much, you can actually see tearing between the layers when you do the retime. So I’m going to switch this back to the default settings. What you can do is render out different flavours of motion vectors. You can render out with a strong setting, maybe a sharp setting, or a smooth setting, then you can select the appropriate motion for your retime, or you can even comp together the result from different settings. Now the key thing for VectorGenerator is the <b>Alignment</b> here. It’s calculating the motion vectors for the left and right views simultaneously. Make sure that they match the alignment data that’s been calculated for the plates. You will see I have connected my VectorGenerator to the upstream VerticalAligners to pick up the solve data, but for the aligned plates. You could actually just calculate that alignment data again if you put in a new Solver node.</p>
                                <p>OK, let’s have a look at the retime now. I have my corrected plates with disparity and the motion vectors I just calculated. I’m pulling them into an Ocula 3.0 Retimer node. The Retimer is quite simple. It allows you to either key a <b>Speed</b> control, or you can specify frames. You can define the warping that’s supplied to the frames to produce the retime results. So let’s have a look at the results of retiming on the left and right views. You will notice there’s some fast motion on the hand here, and that’s causing some ghosting on the retime result. You could look at using a higher <b>Strength</b>, or maybe <b>Sharpness</b>, in the motion vectors to correct this. The important thing here though is that when I switch between left and right, the retime result is the same. That’s because VectorGenerator calculates left and right motion simultaneously.</p>
                                <p>We can compare that result with Kronos retiming, which will be treating the left and right views separately. This is the result with Kronos, and you can see the retime is different. This is going to stand out when you view it in stereo 3D, so just to illustrate that, I will switch to an Anaglyph node. You can see the error jump out when we switch to see the Kronos result. So it’s fairly simple to generate a retime. If there are any errors, you can try generating multiple retimes with different motion vectors and comp together a fix. You can also fix one view and use retimed disparity to push that fix across onto the other view. So, here I’m using a NewView node set to rebuild the retimed right from the left. We can compare that rebuilt view with the original retimed right view, so you can use retimed disparity to help build perfectly matched retimed plates.</p>
                                <p>That wraps up this tutorial on retiming with Ocula 3.0. We have covered setting up and preparing the plate, rendering out, and also rendering out motion vectors using the VectorGenerator node, then pulling that in to do a retime with the Retimer node in Ocula 3.0, and how that can work better than retiming views separately, and also tricks about how to rebuild perfectly matched plates, either by comping together several retimes or by pulling fixes across from one view to the other using retimed disparity.</p>
                            </div>
                        </div>
                        <p>
                            <!-- This version of the embed code is no longer supported. Learn more: https://vimeo.com/help/faq/embedding -->
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <table style="width: 100%;border-bottom-style: solid;border-bottom-width: 1px;">
            <col />
            <tbody>
                <tr>
                    <td>
                        <p>&#160;</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="MCDropDown MCDropDown_Open dropDown dropDownMiniTOCmenu"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCDropDownHotSpot_MiniTOCmenu MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="13" width="16" alt="Closed" data-mc-alt2="Open" />Topics In This Section</a></span>
            <div class="MCDropDownBody dropDownBody">
            </div>
        </div>
    </body>
    <script type="text/javascript">/* <![CDATA[ */
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-60569477-1', {'cookieDomain': 'none'});
	/* ]]> */</script>
    <script type="text/javascript">/* <![CDATA[ */
		$("document").ready(function ()
		{
		function postMe()
		{
		var cust = document.getElementById("search-field").value;
		console.log(cust);
		ga('send', 'event', "Nuke", "search", cust, 9);
		}
		var submitButton = $(".search-submit");
		submitButton.click(function() { postMe(); return true; } );
		var submit = $("input#search-field");
		submit.keypress(function(e) { if(e.keyCode==13) { postMe(); } return true; } );
		});
	/* ]]> */</script>
</html>